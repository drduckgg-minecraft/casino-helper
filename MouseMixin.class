/* Decompiler 35ms, total 123ms, lines 55 */
package com.lakutils.mixin;

import com.lakutils.LakUtils;
import com.lakutils.gui.BetHud;
import net.minecraft.class_312;
import org.spongepowered.asm.mixin.Mixin;
import org.spongepowered.asm.mixin.injection.At;
import org.spongepowered.asm.mixin.injection.Inject;
import org.spongepowered.asm.mixin.injection.callback.CallbackInfo;

@Mixin({class_312.class})
public class MouseMixin {
   @Inject(
      method = {"onMouseButton"},
      at = {@At("HEAD")},
      cancellable = true
   )
   private void onMouseButton(long window, int button, int action, int mods, CallbackInfo ci) {
      if (LakUtils.mc.field_1755 != null) {
         String screenClass = LakUtils.mc.field_1755.getClass().getName();
         boolean isAllowedScreen = screenClass.contains("ChatScreen") || screenClass.contains("InventoryScreen") || screenClass.contains("HandledScreen") || screenClass.contains("GenericContainerScreen") || screenClass.contains("class_408");
         if (!isAllowedScreen) {
            return;
         }
      }

      double mouseY;
      double mouseX;
      if (action == 1) {
         mouseX = LakUtils.mc.field_1729.method_1603() * (double)LakUtils.mc.method_22683().method_4486() / (double)LakUtils.mc.method_22683().method_4480();
         mouseY = LakUtils.mc.field_1729.method_1604() * (double)LakUtils.mc.method_22683().method_4502() / (double)LakUtils.mc.method_22683().method_4507();
         if (BetHud.getInstance().mouseClicked(mouseX, mouseY, button)) {
            ci.cancel();
         }
      } else if (action == 0) {
         mouseX = LakUtils.mc.field_1729.method_1603() * (double)LakUtils.mc.method_22683().method_4486() / (double)LakUtils.mc.method_22683().method_4480();
         mouseY = LakUtils.mc.field_1729.method_1604() * (double)LakUtils.mc.method_22683().method_4502() / (double)LakUtils.mc.method_22683().method_4507();
         if (BetHud.getInstance().mouseReleased(mouseX, mouseY, button)) {
            ci.cancel();
         }
      }

   }

   @Inject(
      method = {"onCursorPos"},
      at = {@At("HEAD")}
   )
   private void onCursorPos(long window, double x, double y, CallbackInfo ci) {
      double mouseX = x * (double)LakUtils.mc.method_22683().method_4486() / (double)LakUtils.mc.method_22683().method_4480();
      double mouseY = y * (double)LakUtils.mc.method_22683().method_4502() / (double)LakUtils.mc.method_22683().method_4507();
      BetHud.getInstance().mouseMoved(mouseX, mouseY);
   }
}
